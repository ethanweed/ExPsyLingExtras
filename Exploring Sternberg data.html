
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exploring Sternberg data &#8212; ExPsyLing Extras</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="By request" href="Figures%20by%20request.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">ExPsyLing Extras</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="landingpage.html">
   ExPsyLing Extras
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="SternbergPlotGallery.html">
   Sternberg Plot Gallery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Figures%20by%20request.html">
   By request
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Exploring Sternberg data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#inspect-the-data">
   Inspect the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#plot-the-data">
   Plot the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#make-a-sternberg-style-plot">
   Make a Sternberg-style plot
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#correlation">
   Correlation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#linear-regression">
   Linear regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#multiple-linear-regression">
   Multiple linear regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#paired-t-test-present-vs-absent">
   paired t-test: present vs. absent
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#other-explorations-of-the-present-vs-absent-conditions">
   Other explorations of the present vs. absent conditions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Exploring Sternberg data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/Exploring Sternberg data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Exploring Sternberg data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inspect-the-data">
   Inspect the data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-the-data">
   Plot the data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-a-sternberg-style-plot">
   Make a Sternberg-style plot
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#correlation">
   Correlation
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-regression">
   Linear regression
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-linear-regression">
   Multiple linear regression
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#paired-t-test-present-vs-absent">
   paired t-test: present vs. absent
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-t-test-results">
     Plotting t-test results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-explorations-of-the-present-vs-absent-conditions">
   Other explorations of the present vs. absent conditions
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="exploring-sternberg-data">
<h1>Exploring Sternberg data<a class="headerlink" href="#exploring-sternberg-data" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import packages</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">ttest_rel</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;notebook&quot;</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load data</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/ExPsyLing/master/datasets/Sternberg/2021/Sternberg_cleaned.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="inspect-the-data">
<h1>Inspect the data<a class="headerlink" href="#inspect-the-data" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># look at the actual data</span>

<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>setSize</th>
      <th>present</th>
      <th>id</th>
      <th>rt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>n</td>
      <td>1</td>
      <td>407.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>n</td>
      <td>2</td>
      <td>848.500000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>n</td>
      <td>3</td>
      <td>549.333333</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>n</td>
      <td>4</td>
      <td>982.333333</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>n</td>
      <td>5</td>
      <td>568.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="plot-the-data">
<h1>Plot the data<a class="headerlink" href="#plot-the-data" title="Permalink to this headline">¶</a></h1>
<p>Here I have plotted all the indivdual data points, plus two regression lines. I have added a bit of random noise (jitter) to the x-axis, so that we can see all data points. By plotting two different lines through the data, I am foreshadowing a multiple linear regression analysis: using both <code class="docutils literal notranslate"><span class="pre">setSize</span></code> and <code class="docutils literal notranslate"><span class="pre">present</span></code> to model the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;setSize&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;rt&quot;</span><span class="p">,</span>
    <span class="n">hue</span> <span class="o">=</span> <span class="s2">&quot;present&quot;</span><span class="p">,</span>
    <span class="n">x_jitter</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Response time (ms) for differently-sized memory sets&quot;</span><span class="p">,</span>
               <span class="n">y</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.1, &#39;Response time (ms) for differently-sized memory sets&#39;)
</pre></div>
</div>
<img alt="_images/Exploring Sternberg data_6_1.png" src="_images/Exploring Sternberg data_6_1.png" />
</div>
</div>
</div>
<div class="section" id="make-a-sternberg-style-plot">
<h1>Make a Sternberg-style plot<a class="headerlink" href="#make-a-sternberg-style-plot" title="Permalink to this headline">¶</a></h1>
<p>To better understand our results, I would like to make a plot that resembles Sternberg’s as closely as possible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make Sternberg-style plot</span>

<span class="c1"># plot the mean value for each set size, for positive and negative memory sets,</span>
<span class="c1"># with error bars, but don&#39;t make two different lines</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;setSize&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;rt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;present&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">err_style</span><span class="o">=</span><span class="s1">&#39;bars&#39;</span><span class="p">)</span>

<span class="c1"># overlay a single line, modelling response time only as a function of setSize</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;setSize&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;rt&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># shorten the y-axis a little, since we are no longer plotting all the data points</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1"># make the plot square, to look more like Sternberg&#39;s</span>
<span class="n">x0</span><span class="p">,</span><span class="n">x1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
<span class="n">y0</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">))</span>

<span class="c1"># tuck the legend into an inobstrusive corner</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

<span class="c1"># remove the top and bottom borders, even though Sternberg didn&#39;t.</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Exploring Sternberg data_8_0.png" src="_images/Exploring Sternberg data_8_0.png" />
</div>
</div>
</div>
<div class="section" id="correlation">
<h1>Correlation<a class="headerlink" href="#correlation" title="Permalink to this headline">¶</a></h1>
<p>A single straight line through the data points can be interpeted as a correlation. We can plot this with e.g. <code class="docutils literal notranslate"><span class="pre">regplot</span></code>, and calculate the Pearson’s correlation coefficient (r) using <code class="docutils literal notranslate"><span class="pre">.corr()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the data with a single </span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;setSize&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Exploring Sternberg data_10_0.png" src="_images/Exploring Sternberg data_10_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate r and round off to the nearest 3 decimal places</span>
<span class="n">r</span> <span class="o">=</span> <span class="s1">&#39;r = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;setSize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;rt&#39;</span><span class="p">]),</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;r = 0.266&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="linear-regression">
<h1>Linear regression<a class="headerlink" href="#linear-regression" title="Permalink to this headline">¶</a></h1>
<p>Pearson’s correlation calculates the strength of the relationship between two variables (in our case <code class="docutils literal notranslate"><span class="pre">setSize</span></code> and <code class="docutils literal notranslate"><span class="pre">rt</span></code>, but we can also go a step further and caclulate a linear regression. In a regression analysis, we think of one variable as “predicting” values in another variable. The regression line, that is, the slope and y-intercept of the line, is our model. A simple way to do this is with <code class="docutils literal notranslate"><span class="pre">scipy.stats.lingress</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;setSize&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;rt&#39;</span><span class="p">])</span>

<span class="n">res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LinregressResult(slope=28.16583683101391, intercept=646.3428547386319, rvalue=0.2661705204139128, pvalue=1.8537720725147673e-05, stderr=6.4511386658734535, intercept_stderr=25.12357557440091)
</pre></div>
</div>
</div>
</div>
<p>Again, for a single predictor, this is the same as correlation. The r-value is the same.  However, in linear regression, we usually report the <span class="math notranslate nohighlight">\(R^2\)</span> value, which represents the amount of variance in the data accounted for by our model. This becomes important when e.g. comparing models that might have more than one predictor. To obtain <span class="math notranslate nohighlight">\(R^2\)</span> from <code class="docutils literal notranslate"><span class="pre">lingress</span></code>, you can just multiply the r-value by itself:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R2 = &#39;</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">rvalue</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R2 =  0.07084674593741318
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="multiple-linear-regression">
<h1>Multiple linear regression<a class="headerlink" href="#multiple-linear-regression" title="Permalink to this headline">¶</a></h1>
<p>Then again, maybe we want to model our data with more than one predictor. In that case, we can turn to multiple regression. Here the best option in my opinion is to use <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>. With <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>, we define our model as a “formula”. This is also the typcial way models our defined in the R programming language. We use a <code class="docutils literal notranslate"><span class="pre">~</span></code> to mean “predicted by”, so <code class="docutils literal notranslate"><span class="pre">rt</span> <span class="pre">~</span> <span class="pre">setSize</span></code> means “rt predicted by setSize”. We can start with a one-predictor model, to verify that the results are the same as <code class="docutils literal notranslate"><span class="pre">lingress</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basic model: same as scipy linregres</span>

<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="n">formula</span> <span class="o">=</span> <span class="s2">&quot;rt ~ setSize&quot;</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model1</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>rt</td>        <th>  R-squared:         </th> <td>   0.071</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.067</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   19.06</td>
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 02 Nov 2021</td> <th>  Prob (F-statistic):</th> <td>1.85e-05</td>
</tr>
<tr>
  <th>Time:</th>                 <td>23:23:03</td>     <th>  Log-Likelihood:    </th> <td> -1657.9</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   252</td>      <th>  AIC:               </th> <td>   3320.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   250</td>      <th>  BIC:               </th> <td>   3327.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>  646.3429</td> <td>   25.124</td> <td>   25.727</td> <td> 0.000</td> <td>  596.862</td> <td>  695.824</td>
</tr>
<tr>
  <th>setSize</th>   <td>   28.1658</td> <td>    6.451</td> <td>    4.366</td> <td> 0.000</td> <td>   15.460</td> <td>   40.871</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>15.701</td> <th>  Durbin-Watson:     </th> <td>   2.736</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  11.614</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.416</td> <th>  Prob(JB):          </th> <td> 0.00301</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.357</td> <th>  Cond. No.          </th> <td>    9.36</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<p>Yup. There is a lot of output here, but the <span class="math notranslate nohighlight">\(R^2\)</span> is the same as we found with <code class="docutils literal notranslate"><span class="pre">lingress</span></code>: 0.071. And in fact, if we take the square root for that, we are all the way back to our r-value from the Pearson correlation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r = &#39;</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.071</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r =  0.2664582518894845
</pre></div>
</div>
</div>
</div>
<p>Now we can also add a second predictor. In this case, we have one other variable we can use to “account for” or “explain” the variation in our data: the presence/absence condition. With <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>, we can just add our second predictor variable to the formula:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model with two predictors</span>

<span class="n">formula</span> <span class="o">=</span> <span class="s2">&quot;rt ~ setSize + present&quot;</span>
<span class="n">model2</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>rt</td>        <th>  R-squared:         </th> <td>   0.075</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.068</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   10.15</td>
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 02 Nov 2021</td> <th>  Prob (F-statistic):</th> <td>5.77e-05</td>
</tr>
<tr>
  <th>Time:</th>                 <td>23:23:03</td>     <th>  Log-Likelihood:    </th> <td> -1657.3</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   252</td>      <th>  AIC:               </th> <td>   3321.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   249</td>      <th>  BIC:               </th> <td>   3331.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
        <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>    <td>  658.5391</td> <td>   27.421</td> <td>   24.016</td> <td> 0.000</td> <td>  604.533</td> <td>  712.545</td>
</tr>
<tr>
  <th>present[T.y]</th> <td>  -24.3924</td> <td>   22.025</td> <td>   -1.107</td> <td> 0.269</td> <td>  -67.771</td> <td>   18.986</td>
</tr>
<tr>
  <th>setSize</th>      <td>   28.1658</td> <td>    6.448</td> <td>    4.368</td> <td> 0.000</td> <td>   15.466</td> <td>   40.866</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>15.710</td> <th>  Durbin-Watson:     </th> <td>   2.744</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  12.208</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.440</td> <th>  Prob(JB):          </th> <td> 0.00223</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.376</td> <th>  Cond. No.          </th> <td>    11.0</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<p>Interstingly enough, adding a second predictor didn’t do a lot to improve our model. Put another way, if we had to guess what any participants response time for a particular item was, we wouldn’t really be any more accurate if we know whether the value came from a positive or negative memory set than we would be if we only know the size of the memory set. We can actually do a significance test on the two models, to see if there is any signficant difference between the two. In this case, we get a <span class="math notranslate nohighlight">\(p\)</span>-value of 0.27:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.stats.anova</span> <span class="kn">import</span> <span class="n">anova_lm</span>
<span class="n">anova_lm</span><span class="p">(</span><span class="n">model1</span><span class="p">,</span> <span class="n">model2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>df_resid</th>
      <th>ssr</th>
      <th>df_diff</th>
      <th>ss_diff</th>
      <th>F</th>
      <th>Pr(&gt;F)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>250.0</td>
      <td>7.647159e+06</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>249.0</td>
      <td>7.609674e+06</td>
      <td>1.0</td>
      <td>37484.471827</td>
      <td>1.226548</td>
      <td>0.269148</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="paired-t-test-present-vs-absent">
<h1>paired t-test: present vs. absent<a class="headerlink" href="#paired-t-test-present-vs-absent" title="Permalink to this headline">¶</a></h1>
<p>Finally, if we wanted to, we could also simply compare the mean of the values from the negative memory set condition and the positive memory set condition with a <span class="math notranslate nohighlight">\(t\)</span>-test. We will use a paired <span class="math notranslate nohighlight">\(t\)</span>-test, because the data come from the same participants in both conditions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">ttest_rel</span>

<span class="n">df_ttest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;present&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;present&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="s1">&#39;rt&#39;</span><span class="p">]),</span>
     <span class="s1">&#39;absent&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;present&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span><span class="p">][</span><span class="s1">&#39;rt&#39;</span><span class="p">])</span>
     <span class="p">})</span>

<span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">df_ttest</span><span class="p">[</span><span class="s1">&#39;absent&#39;</span><span class="p">],</span> <span class="n">df_ttest</span><span class="p">[</span><span class="s1">&#39;present&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t =&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p =&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t = 2.32
p = 0.022
</pre></div>
</div>
</div>
</div>
<div class="section" id="plotting-t-test-results">
<h2>Plotting t-test results<a class="headerlink" href="#plotting-t-test-results" title="Permalink to this headline">¶</a></h2>
<p>Plotting the means of the two memory set conditions can either exaggerate or diminish their apparent differences:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df_ttest</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="_images/Exploring Sternberg data_27_1.png" src="_images/Exploring Sternberg data_27_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df_ttest</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="_images/Exploring Sternberg data_28_1.png" src="_images/Exploring Sternberg data_28_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df_ttest</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Exploring Sternberg data_29_0.png" src="_images/Exploring Sternberg data_29_0.png" />
</div>
</div>
<p>To my eye, the pointplot makes the means look more different from each other, and the barplot and boxplot make them look more similar. The data are the same in all cases, of course.</p>
</div>
</div>
<div class="section" id="other-explorations-of-the-present-vs-absent-conditions">
<h1>Other explorations of the present vs. absent conditions<a class="headerlink" href="#other-explorations-of-the-present-vs-absent-conditions" title="Permalink to this headline">¶</a></h1>
<p>If we correlate the present and absent data, we find that they are highly corrrelated, which make sense since the two lines follow essentially the same slope:</p>
<p>print(‘r =’, round(df_ttest[‘present’].corr(df_ttest[‘absent’]), 3))</p>
</div>
<div class="section" id="conclusion">
<h1>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h1>
<p>So, in our data, there is a signficiant difference between the overall mean of response times in the positive and negative memory sets, but adding the positive vs. negative memory set variable to the regression model didn’t significantly improve our ability to account for our results. There are other sources of variance left unaccounted for. In fact, there is quite a lot of variance unaccounted for in our data: Sternberg reports an <span class="math notranslate nohighlight">\(R^2\)</span> of 0.994, that is 99.4 % of the variance accounted for by the model, while our <span class="math notranslate nohighlight">\(R^2\)</span> is only 0.075.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="Figures%20by%20request.html" title="previous page">By request</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ethan Weed<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>